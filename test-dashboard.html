<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USASpending Dashboard Test</title>
    <style>
        /* Modern, professional styling */
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: "Source Sans Pro", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            line-height: 1.6;
        }
        
        .test-container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(0,0,0,0.05);
        }
        
        h1 {
            color: #1a1a1a;
            font-size: 2.5rem;
            margin-bottom: 1rem;
            font-weight: 700;
            text-align: center;
        }
        
        .test-link {
            display: inline-block;
            background: #005ea2;
            color: white;
            padding: 16px 32px;
            text-decoration: none;
            border-radius: 6px;
            margin: 15px 10px 15px 0;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 94, 162, 0.3);
        }
        
        .test-link:hover {
            background: #0066cc;
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 94, 162, 0.4);
        }
        
        .feature-list {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 8px;
            margin: 30px 0;
            border-left: 4px solid #005ea2;
        }
        
        .feature-list h3 {
            color: #005ea2;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.4rem;
            font-weight: 600;
        }
        
        .feature-list ul {
            margin: 15px 0;
            padding-left: 0;
        }
        
        .feature-list li {
            margin: 10px 0;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            list-style: none;
            position: relative;
            padding-left: 20px;
        }
        
        .feature-list li:before {
            content: "‚ñ∏";
            color: #005ea2;
            position: absolute;
            left: 0;
            font-weight: bold;
        }
        
        .feature-list li:last-child {
            border-bottom: none;
        }
        
        .status {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            display: inline-block;
            margin: 8px 8px 8px 0;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .status.complete {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.updated {
            background: #cce5ff;
            color: #004085;
            border: 1px solid #b3d7ff;
        }
        
        p {
            font-size: 1.1rem;
            color: #333;
            margin: 20px 0;
        }
        
        strong {
            color: #005ea2;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .test-container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .test-link {
                display: block;
                text-align: center;
                margin: 10px 0;
            }
            
            .feature-list {
                padding: 20px;
            }
        }
        
        /* Links within feature lists */
        .feature-list a {
            color: #005ea2;
            text-decoration: none;
            font-weight: 600;
            border-bottom: 1px solid transparent;
            transition: all 0.2s ease;
        }
        
        .feature-list a:hover {
            color: #0066cc;
            border-bottom-color: #0066cc;
        }
        
        /* Status indicators */
        .status-indicator {
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.9rem;
        }
        
        .status-online {
            background: #d4edda;
            color: #155724;
        }
        
        .status-offline {
            background: #f8d7da;
            color: #721c24;
        }
        
        /* Print styles */
        @media print {
            body {
                background: white;
            }
            
            .test-container {
                box-shadow: none;
                border: 1px solid #ccc;
            }
            
            .test-link {
                background: #005ea2 !important;
                color: white !important;
            }
        }
    </style>
</head>
<body>
    <header role="banner">
        <div class="test-container">
            <h1>üéØ USASpending Dashboard - USWDS Update Complete</h1>
            
            <div class="status complete" role="status" aria-label="Update status">‚úÖ Update Complete</div>
            
            <p>The USASpending Code Intelligence Dashboard has been successfully updated to use the US Web Design Standards (USWDS) with a dark mode color scheme.</p>
        
        <nav role="navigation" aria-label="Quick actions">
            <a href="/dashboard" class="test-link">üöÄ Launch Updated Dashboard</a>
        </nav>
    </header>
    
    <main role="main">
        <div class="test-container">
            <section aria-labelledby="whats-new-heading">
                <div class="feature-list">
                    <h3 id="whats-new-heading">üÜï What's New</h3>
                    <ul role="list">
                        <li><span class="status updated">NEW</span> Official US Government Banner (required for federal websites)</li>
                        <li><span class="status updated">NEW</span> USWDS 3.8.2 Components and Styling</li>
                        <li><span class="status updated">NEW</span> Dark Mode Color Scheme</li>
                        <li><span class="status updated">NEW</span> Improved Accessibility Features</li>
                        <li><span class="status updated">NEW</span> Responsive Grid System</li>
                        <li><span class="status updated">NEW</span> USWDS Typography and Spacing</li>
                    </ul>
                </div>
            </section>
            
            <section aria-labelledby="technical-updates-heading">
                <div class="feature-list">
                    <h3 id="technical-updates-heading">üîß Technical Updates</h3>
                    <ul role="list">
                        <li><strong>HTML Structure:</strong> Updated to use USWDS components (cards, buttons, navigation, search)</li>
                        <li><strong>CSS Framework:</strong> Replaced custom styles with USWDS-based dark theme</li>
                        <li><strong>Navigation:</strong> Updated to use USWDS sidenav component</li>
                        <li><strong>Color Palette:</strong> USWDS-inspired dark mode colors with proper contrast ratios</li>
                        <li><strong>Typography:</strong> Source Sans Pro font family (USWDS standard)</li>
                        <li><strong>Accessibility:</strong> Enhanced ARIA labels, focus indicators, and screen reader support</li>
                    </ul>
                </div>
            </section>
            
            <section aria-labelledby="design-features-heading">
                <div class="feature-list">
                    <h3 id="design-features-heading">üé® Design Features</h3>
                    <ul role="list">
                        <li><strong>Dark Theme:</strong> Professional dark color scheme optimized for code analysis</li>
                        <li><strong>Federal Compliance:</strong> Includes required US government banner</li>
                        <li><strong>Responsive Design:</strong> Works on desktop, tablet, and mobile devices</li>
                        <li><strong>USWDS Components:</strong> Cards, buttons, search, navigation, and summary boxes</li>
                        <li><strong>Consistent Spacing:</strong> Uses USWDS spacing units system</li>
                        <li><strong>Hover Effects:</strong> Subtle animations and state changes</li>
                    </ul>
                </div>
            </section>
            
            <section aria-labelledby="dashboard-sections-heading">
                <div class="feature-list">
                    <h3 id="dashboard-sections-heading">üîç Dashboard Sections</h3>
                    <ul role="list">
                        <li>üìä <strong>System Overview:</strong> Statistics and charts</li>
                        <li>üìÅ <strong>Files Analysis:</strong> Code file breakdown</li>
                        <li>üèóÔ∏è <strong>Classes Analysis:</strong> Class structure overview</li>
                        <li>‚öôÔ∏è <strong>Functions Analysis:</strong> Function complexity metrics</li>
                        <li>üåê <strong>Code Relationships:</strong> Dependency visualization</li>
                        <li>üì¶ <strong>Dependencies:</strong> Module and library analysis</li>
                        <li>üèõÔ∏è <strong>Architectural Layers:</strong> System architecture view</li>
                        <li>üéØ <strong>Complexity Analysis:</strong> Code complexity metrics</li>
                        <li>üè∑Ô∏è <strong>Domain Analysis:</strong> Business domain breakdown</li>
                    </ul>
                </div>
            </section>
        
            <section aria-labelledby="keyboard-shortcuts-heading">
                <div class="feature-list">
                    <h3 id="keyboard-shortcuts-heading">‚å®Ô∏è Keyboard Shortcuts</h3>
                    <ul role="list">
                        <li><strong>Ctrl+K:</strong> Focus search</li>
                        <li><strong>Ctrl+1-7:</strong> Quick section navigation</li>
                        <li><strong>Alt+‚Üê:</strong> Go back to previous section</li>
                    </ul>
                </div>
            </section>
            
            <section aria-labelledby="quick-links-heading">
                <div class="feature-list">
                    <h3 id="quick-links-heading">üîó Quick Links</h3>
                    <ul role="list">
                        <li><strong>API Documentation:</strong> <a href="/docs" target="_blank" aria-label="Open API documentation in new tab">Interactive API Docs</a></li>
                        <li><strong>Health Check:</strong> <a href="/health" target="_blank" aria-label="Check server health status in new tab">Server Status</a></li>
                        <li><strong>System Stats:</strong> <a href="/api/stats" target="_blank" aria-label="View live system statistics in new tab">Live Statistics</a></li>
                    </ul>
                </div>
            </section>
            
            <section aria-labelledby="server-info-heading">
                <div class="feature-list">
                    <h3 id="server-info-heading">üìã Server Information</h3>
                    <ul role="list">
                        <li><strong>Server Status:</strong> <span id="serverStatus" aria-live="polite">Checking...</span></li>
                        <li><strong>Database:</strong> <span id="dbStatus" aria-live="polite">Checking...</span></li>
                        <li><strong>Files Analyzed:</strong> <span id="filesCount" aria-live="polite">Loading...</span></li>
                        <li><strong>Last Updated:</strong> <span id="lastUpdated" aria-live="polite">Loading...</span></li>
                    </ul>
                </div>
            </section>
        </div>
    </main>
    
    <footer role="contentinfo">
        <div class="test-container">
            <p><strong>Note:</strong> The dashboard maintains all existing functionality while providing a more professional, accessible, and federally-compliant user interface.</p>
            
            <nav role="navigation" aria-label="Main actions" style="text-align: center; margin: 40px 0;">
                <a href="/dashboard" class="test-link" aria-label="Open the main dashboard">üéØ Open Dashboard</a>
                <a href="/docs" class="test-link" style="background: #28a745;" aria-label="View API documentation">üìö API Docs</a>
            </nav>
        </div>
    </footer>

    <script>
        // Check server status and load basic info
        async function checkServerStatus() {
            const statusElements = {
                server: document.getElementById('serverStatus'),
                db: document.getElementById('dbStatus'),
                files: document.getElementById('filesCount'),
                updated: document.getElementById('lastUpdated')
            };
            
            try {
                // Add loading animation
                Object.values(statusElements).forEach(el => {
                    if (el) el.innerHTML = '<span style="opacity: 0.6;">‚è≥ Loading...</span>';
                });
                
                const healthResponse = await fetch('/health', {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Cache-Control': 'no-cache'
                    }
                });
                
                if (!healthResponse.ok) {
                    throw new Error(`HTTP ${healthResponse.status}: ${healthResponse.statusText}`);
                }
                
                const healthData = await healthResponse.json();
                
                // Update status indicators with proper styling
                if (statusElements.server) {
                    statusElements.server.innerHTML = healthData.status === 'healthy' 
                        ? '<span class="status-indicator status-online">‚úÖ Online</span>' 
                        : '<span class="status-indicator status-offline">‚ùå Issues</span>';
                }
                
                if (statusElements.db) {
                    statusElements.db.innerHTML = healthData.database === 'connected' 
                        ? '<span class="status-indicator status-online">‚úÖ Connected</span>' 
                        : '<span class="status-indicator status-offline">‚ùå Disconnected</span>';
                }
                
                if (statusElements.files) {
                    statusElements.files.textContent = healthData.files_count ? 
                        `${healthData.files_count.toLocaleString()} files` : 'Unknown';
                }
                
                if (statusElements.updated) {
                    statusElements.updated.textContent = healthData.timestamp ? 
                        new Date(healthData.timestamp).toLocaleString() : 'Unknown';
                }
                
                console.log('‚úÖ Server status check successful:', healthData);
                
            } catch (error) {
                console.error('‚ùå Failed to check server status:', error);
                
                // Update with error states
                if (statusElements.server) {
                    statusElements.server.innerHTML = '<span class="status-indicator status-offline">‚ùå Offline</span>';
                }
                if (statusElements.db) {
                    statusElements.db.innerHTML = '<span class="status-indicator status-offline">‚ùå Unavailable</span>';
                }
                if (statusElements.files) {
                    statusElements.files.textContent = 'N/A';
                }
                if (statusElements.updated) {
                    statusElements.updated.textContent = 'N/A';
                }
                
                // Show user-friendly error message
                const errorMsg = document.createElement('div');
                errorMsg.style.cssText = `
                    background: #f8d7da;
                    color: #721c24;
                    padding: 12px;
                    border-radius: 6px;
                    margin: 20px 0;
                    border: 1px solid #f5c6cb;
                    font-size: 0.9rem;
                `;
                errorMsg.innerHTML = `
                    <strong>‚ö†Ô∏è Connection Issue:</strong> Unable to connect to the dashboard server. 
                    Please ensure the server is running on port 8001.
                `;
                
                const container = document.querySelector('.test-container');
                if (container && !container.querySelector('.error-message')) {
                    errorMsg.className = 'error-message';
                    container.insertBefore(errorMsg, container.firstChild.nextSibling);
                }
            }
        }
        
        // Add interactive effects to buttons
        function addInteractiveEffects() {
            document.querySelectorAll('.test-link').forEach(link => {
                link.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-2px) scale(1.02)';
                });
                
                link.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0) scale(1)';
                });
                
                // Add click feedback
                link.addEventListener('mousedown', function() {
                    this.style.transform = 'translateY(0) scale(0.98)';
                });
                
                link.addEventListener('mouseup', function() {
                    this.style.transform = 'translateY(-2px) scale(1.02)';
                });
            });
        }
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ USASpending Dashboard Test Page Loaded');
            checkServerStatus();
            addInteractiveEffects();
            
            // Add refresh button for server status
            const refreshBtn = document.createElement('button');
            refreshBtn.textContent = 'üîÑ Refresh Status';
            refreshBtn.style.cssText = `
                background: #28a745;
                color: white;
                border: none;
                padding: 8px 16px;
                border-radius: 4px;
                cursor: pointer;
                font-size: 0.9rem;
                margin-left: 10px;
                transition: all 0.2s ease;
            `;
            refreshBtn.addEventListener('click', checkServerStatus);
            refreshBtn.addEventListener('mouseenter', function() {
                this.style.background = '#218838';
            });
            refreshBtn.addEventListener('mouseleave', function() {
                this.style.background = '#28a745';
            });
            
            const serverInfoSection = document.querySelector('.feature-list h3');
            if (serverInfoSection && serverInfoSection.textContent.includes('Server Information')) {
                serverInfoSection.appendChild(refreshBtn);
            }
        });
        
        // Add keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            // Ctrl+R or F5 to refresh status
            if ((event.ctrlKey && event.key === 'r') || event.key === 'F5') {
                event.preventDefault();
                checkServerStatus();
            }
            
            // Ctrl+D to open dashboard
            if (event.ctrlKey && event.key === 'd') {
                event.preventDefault();
                window.open('/dashboard', '_blank');
            }
        });
    </script>
</body>
</html>